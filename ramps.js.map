{"version":3,"file":"ramps.js","sources":["../src/js/ramps.js"],"sourcesContent":["// import * as THREE from 'three';\n// import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\n// // import { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader.js';\n// import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\n\n\n// function main() {\n//   const canvas = document.querySelector('#c');\n//   const renderer = new THREE.WebGLRenderer({canvas});\n\n//   const fov = 50;\n//   const aspect = 2;  //холст по умолчанию\n//   const near = 0.1;\n//   const far = 600;\n//   const camera = new THREE.PerspectiveCamera(fov, aspect, near, far);\n//   camera.position.set(50, 50, 100);\n\n//   const controls = new OrbitControls(camera, canvas);\n//   controls.target.set(0, 0, 0);\n//   controls.update();  \n\n\n//   const scene = new THREE.Scene();\n//   scene.background = new THREE.Color('black');\n\n\n//   {\n//     const skyColor = 0x4779F4;  // светло-синий\n//     const groundColor = 0x9E9E9E;  // коричневато-оранжевый\n//     const intensity = 1;\n//     const light = new THREE.HemisphereLight(skyColor, groundColor, intensity);\n//     scene.add(light);\n//   }\n\n//   {\n//     const color = 0x2DEF83;\n//     const intensity = 1;\n//     const light = new THREE.DirectionalLight(color, intensity);\n//     light.position.set(0, 10, 0);\n//     light.target.position.set(-5, 0, 0);\n//     scene.add(light);\n//     scene.add(light.target);\n//   }\n \n\n//   let ourObj;\n  \n//   const toRadians = (degrees) => degrees * (Math.PI / 180);\n//   {\n//     const gltfLoader = new GLTFLoader();\n//     const gltfPath = '/bowl.glb'; // Убедитесь, что путь правильный\n//     console.log(`Пытаемся загрузить ${gltfPath}`);\n//     gltfLoader.load(gltfPath, (gltf) => {\n//       console.log('Объект успешно загружен');\n//       ourObj = gltf.scene;\n//       scene.add(ourObj);\n//       ourObj.rotation.y = toRadians(10);\n//       ourObj.scale.set(0.5, 0.5, 0.5);\n\n//     }, undefined, (error) => {\n//       console.error(`Произошла ошибка при загрузке ${gltfPath}`, error);\n//     });\n\n\n//   }\n\n\n//   {\n//     const gltfLoader = new GLTFLoader();\n//     const gltfPath2 = '/mini.glb'; // Убедитесь, что путь правильный\n//     console.log(`Пытаемся загрузить ${gltfPath2}`);\n//     gltfLoader.load(gltfPath2, (gltf) => {\n//       console.log('Второй объект успешно загружен');\n//       const secondObj = gltf.scene;\n//       scene.add(secondObj);\n//       secondObj.position.set(30, 30, 0); // Устанавливаем позицию второго объекта\n//     }, undefined, (error) => {\n//       console.error(`Произошла ошибка при загрузке ${gltfPath2}`, error);\n//     });\n//   }\n  \n//   function resizeRendererToDisplaySize(renderer) {\n//     const canvas = renderer.domElement;\n//     const width = canvas.clientWidth;\n//     const height = canvas.clientHeight;\n//     const needResize = canvas.width !== width || canvas.height !== height;\n//     if (needResize) {\n//       renderer.setSize(width, height, false);\n//     }\n//     return needResize;\n//   }\n\n//   function render() {\n\n//     if (resizeRendererToDisplaySize(renderer)) {\n//       const canvas = renderer.domElement;\n//       camera.aspect = canvas.clientWidth / canvas.clientHeight;\n//       camera.updateProjectionMatrix();\n//     }\n \n//     renderer.render(scene, camera);\n\n    \n//     requestAnimationFrame(render);\n\n\n//     renderer.render(scene, camera);\n//   }\n\n//   requestAnimationFrame(render);\n// }\n\n// main();\n\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\n\nlet sceneManagers = [];\n\nclass SceneManager {\n  constructor(canvasId, modelPath) {\n    console.log(`Инициализация SceneManager для canvasId: ${canvasId} и modelPath: ${modelPath}`);\n    this.canvas = document.querySelector(canvasId);\n    if (!this.canvas) {\n      console.error(`Canvas с ID ${canvasId} не найден`);\n      return;\n    }\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.setSize(this.canvas.clientWidth, this.canvas.clientHeight);\n    console.log('Renderer успешно инициализирован');\n\n    this.camera = new THREE.PerspectiveCamera(50, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 600);\n    this.camera.position.set(15, 5, 17);\n    console.log('Камера успешно инициализирована');\n\n    this.scene = new THREE.Scene();\n    console.log('Сцена успешно инициализирована');\n\n    this.addLights();\n    this.loadModel(modelPath);\n\n    this.isMouseOver = false;\n    this.canvas.addEventListener('mousemove', (event) => this.onMouseMove(event));\n    this.canvas.addEventListener('mouseleave', () => this.isMouseOver = false);\n    this.canvas.addEventListener('mouseenter', () => this.isMouseOver = true);\n\n    window.addEventListener('resize', () => this.onWindowResize(), false);\n\n    // Добавление текущего экземпляра в массив\n    sceneManagers.push(this);\n  }\n\n  addLights() {\n    console.log('Добавляем освещение');\n    const skyColor = 0x4779F4;\n    const groundColor = 0x9E9E9E;\n    const intensity = 1;\n    const hemisphereLight = new THREE.HemisphereLight(skyColor, groundColor, intensity);\n    this.scene.add(hemisphereLight);\n\n    const color = 0x2DEF83;\n    const directionalLight = new THREE.DirectionalLight(color, intensity);\n    directionalLight.position.set(0, 10, 0);\n    directionalLight.target.position.set(-5, 0, 0);\n    this.scene.add(directionalLight);\n    this.scene.add(directionalLight.target);\n    console.log('Освещение добавлено');\n  }\n\n  loadModel(modelPath) {\n    console.log(`Пытаемся загрузить модель из ${modelPath}`);\n    const gltfLoader = new GLTFLoader();\n    gltfLoader.load(modelPath, (gltf) => {\n      console.log('Объект успешно загружен');\n\n      this.modelGroup = new THREE.Group();\n      this.scene.add(this.modelGroup);\n\n      this.model = gltf.scene;\n      this.modelGroup.add(this.model);\n\n      // Предполагаем, что модель состоит из нескольких частей\n      this.parts = [];\n      this.model.traverse((child) => {\n        if (child.isMesh) {\n          this.parts.push(child);\n          // Сохраняем начальную позицию\n          child.userData.initialPosition = child.position.clone();\n          // Разбрасываем по оси Z\n          child.position.z += Math.random() * 20 - 10;\n          child.userData.scatteredPosition = child.position.clone();\n        }\n      });\n\n      console.log('Добавляем объект в сцену');\n    }, undefined, (error) => {\n      console.error(`Произошла ошибка при загрузке ${modelPath}`, error);\n    });\n  }\n\n  onMouseMove(event) {\n    const canvasRect = this.canvas.getBoundingClientRect();\n    const canvasX = event.clientX - canvasRect.left;\n    const canvasY = event.clientY - canvasRect.top;\n\n    const normalizedX = (canvasX / this.canvas.clientWidth) * 2 - 1; // нормализуем координаты канваса\n    const normalizedY = -(canvasY / this.canvas.clientHeight) * 2 + 1;\n\n    const raycaster = new THREE.Raycaster();\n    raycaster.setFromCamera({ x: normalizedX, y: normalizedY }, this.camera);\n    raycaster.far = 50; // увеличиваем расстояние действия луча\n\n    const intersects = raycaster.intersectObjects(this.scene.children, true);\n\n    if (intersects.length > 0) {\n      const object = intersects[0].object;\n      if (object.userData.initialPosition) {\n        const initialPosition = object.userData.initialPosition;\n        object.position.lerp(initialPosition, 0.3); // увеличиваем скорость сборки\n      }\n    }\n  }\n\n  onWindowResize() {\n    const canvas = this.renderer.domElement;\n    const width = canvas.clientWidth;\n    const height = canvas.clientHeight;\n    if (canvas.width !== width || canvas.height !== height) {\n      this.renderer.setSize(width, height, false);\n      this.camera.aspect = width / height;\n      this.camera.updateProjectionMatrix();\n    }\n  }\n\n  updatePartsPositions(scrollPercentage) {\n    if (!this.parts) return;\n\n    this.parts.forEach((part) => {\n      const initialPosition = part.userData.initialPosition;\n      // Анимируем части от начальной позиции к позиции (0,0,0)\n      part.position.lerpVectors(initialPosition, new THREE.Vector3(0, 0, 0), scrollPercentage);\n    });\n  }\n\n  render() {\n    this.onWindowResize();\n    this.renderer.render(this.scene, this.camera);\n  }\n}\n\nfunction animate() {\n  sceneManagers.forEach(manager => manager.render());\n  requestAnimationFrame(animate);\n}\n\nfunction main() {\n  console.log('Запуск main функции');\n  new SceneManager('#c1', '/mini.glb');\n\n  animate();\n\n  window.addEventListener('scroll', () => {\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n    const docHeight = document.documentElement.scrollHeight - window.innerHeight;\n    const scrollPercentage = scrollTop / docHeight;\n\n    sceneManagers.forEach(manager => manager.updatePartsPositions(scrollPercentage));\n  });\n}\n\nmain();\n"],"names":["sceneManagers","SceneManager","canvasId","modelPath","THREE.WebGLRenderer","THREE.PerspectiveCamera","THREE.Scene","event","skyColor","groundColor","intensity","hemisphereLight","THREE.HemisphereLight","color","directionalLight","THREE.DirectionalLight","GLTFLoader","gltf","THREE.Group","child","error","canvasRect","canvasX","canvasY","normalizedX","normalizedY","raycaster","THREE.Raycaster","intersects","object","initialPosition","canvas","width","height","scrollPercentage","part","THREE.Vector3","animate","manager","main","scrollTop","docHeight"],"mappings":"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"}